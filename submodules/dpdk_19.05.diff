diff --git a/.gitignore b/.gitignore
index 5eda2c31e..a9b4eac0d 100644
--- a/.gitignore
+++ b/.gitignore
@@ -27,3 +27,5 @@ TAGS
 # ignore default build directory, and directories from test-meson-builds.sh
 build
 build-*
+/build/
+/x86_64-native-linuxapp-gcc/
diff --git a/config/.gitignore b/config/.gitignore
new file mode 100644
index 000000000..72fb9bd92
--- /dev/null
+++ b/config/.gitignore
@@ -0,0 +1,2 @@
+# this file is now generated by CMake.
+/common_base
diff --git a/config/common_base b/config/common_base.in
similarity index 98%
rename from config/common_base
rename to config/common_base.in
index 6b96e0e80..1f721d7a2 100644
--- a/config/common_base
+++ b/config/common_base.in
@@ -336,14 +336,14 @@ CONFIG_RTE_LIBRTE_IPN3KE_PMD=y
 #
 # Compile burst-oriented Mellanox ConnectX-3 (MLX4) PMD
 #
-CONFIG_RTE_LIBRTE_MLX4_PMD=n
+CONFIG_RTE_LIBRTE_MLX4_PMD=${DPDK_CONFIG_RTE_LIBRTR_MLX4_PMD}
 CONFIG_RTE_LIBRTE_MLX4_DEBUG=n
 
 #
 # Compile burst-oriented Mellanox ConnectX-4, ConnectX-5,
 # ConnectX-6 & Bluefield (MLX5) PMD
 #
-CONFIG_RTE_LIBRTE_MLX5_PMD=n
+CONFIG_RTE_LIBRTE_MLX5_PMD=${DPDK_CONFIG_RTE_LIBRTR_MLX5_PMD}
 CONFIG_RTE_LIBRTE_MLX5_DEBUG=n
 
 # Linking method for mlx4/5 dependency on ibverbs and related libraries
@@ -482,7 +482,7 @@ CONFIG_RTE_LIBRTE_NETVSC_DEBUG_DUMP=n
 #
 # Compile virtual device driver for NetVSC on Hyper-V/Azure
 #
-CONFIG_RTE_LIBRTE_VDEV_NETVSC_PMD=n
+CONFIG_RTE_LIBRTE_VDEV_NETVSC_PMD=${DPDK_CONFIG_RTE_LIBRTE_VDEV_NETVSC_PMD}
 
 #
 # Compile null PMD
@@ -873,7 +873,7 @@ CONFIG_RTE_LIBRTE_NET=y
 #
 CONFIG_RTE_LIBRTE_IP_FRAG=y
 CONFIG_RTE_LIBRTE_IP_FRAG_DEBUG=n
-CONFIG_RTE_LIBRTE_IP_FRAG_MAX_FRAG=4
+CONFIG_RTE_LIBRTE_IP_FRAG_MAX_FRAG=64
 CONFIG_RTE_LIBRTE_IP_FRAG_TBL_STAT=n
 
 #
diff --git a/mk/rte.app.mk b/mk/rte.app.mk
index 7c9b4b538..058add98b 100644
--- a/mk/rte.app.mk
+++ b/mk/rte.app.mk
@@ -374,6 +374,11 @@ O_TO_EXE = $(LD) -o $@ $(OBJS-y) \
 	$(LDLIBS) $(LDFLAGS) $(LDFLAGS_$(@)) $(EXTRA_LDFLAGS) \
 	$(MAPFLAGS)
 endif
+
+# get DPDK to divulge the correct linker flags (borrowed from mTCP).
+$(shell if [ ! -d ${RTE_SDK}/${RTE_TARGET}/lib ]; then mkdir -p ${RTE_SDK}/${RTE_TARGET}/lib; fi)
+$(shell echo $(call linkerprefix,$(LDLIBS)) > ${RTE_SDK}/${RTE_TARGET}/lib/ldflags.txt)
+
 O_TO_EXE_STR = $(subst ','\'',$(O_TO_EXE)) #'# fix syntax highlight
 O_TO_EXE_DISP = $(if $(V),"$(O_TO_EXE_STR)","  LD $(@)")
 O_TO_EXE_CMD = "cmd_$@ = $(O_TO_EXE_STR)"
diff --git a/mk/rte.cpuflags.mk b/mk/rte.cpuflags.mk
index 541211c61..b497fd5e2 100644
--- a/mk/rte.cpuflags.mk
+++ b/mk/rte.cpuflags.mk
@@ -118,3 +118,7 @@ space:= $(empty) $(empty)
 CPUFLAGSTMP1 := $(addprefix RTE_CPUFLAG_,$(CPUFLAGS))
 CPUFLAGSTMP2 := $(subst $(space),$(comma),$(CPUFLAGSTMP1))
 CPUFLAGS_LIST := -DRTE_COMPILE_TIME_CPUFLAGS=$(CPUFLAGSTMP2)
+
+# get DPDK to divulge the correct compiler flags (borrowed from mTCP).
+$(shell if [ ! -d ${RTE_SDK}/${RTE_TARGET}/include ]; then mkdir -p ${RTE_SDK}/${RTE_TARGET}/include; fi)
+$(shell echo ${MACHINE_CFLAGS} > ${RTE_SDK}/${RTE_TARGET}/include/cflags.txt)
diff --git a/usertools/dpdk-setup.sh b/usertools/dpdk-setup.sh
index d00807420..4b82d65eb 100755
--- a/usertools/dpdk-setup.sh
+++ b/usertools/dpdk-setup.sh
@@ -76,7 +76,7 @@ setup_target()
 		fi
 	fi
 	if [ "$QUIT" == "0" ] ; then
-		make install T=${RTE_TARGET}
+		make -j install T=${RTE_TARGET}
 	fi
 	echo "------------------------------------------------------------------------------"
 	echo " RTE_TARGET exported as $RTE_TARGET"
